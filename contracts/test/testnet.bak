import { expect } from "chai";
import hre from "hardhat";

describe("Cronos Testnet Deployed Contracts", function () {
  it("should have the correct roles granted in RWAAssetRegistry", async function () {
    const ethers = hre.ethers;
    const DEPLOYED_ADDRESSES = {
      registry: "0xECfcBe5d9F89fAB1818c9D582b2d54c9fFf8E0Eb",
    };

    const ADMIN_ADDRESS = "0xE5d7e81226E2Ca1355F8954673eCe59Fe40fDBFd";
    const AGENT_ADDRESS = "0x09ef97ea756496cd7a8E6a045B033A17A0B2B4A0";

    const registry = await ethers.getContractAt(
      "RWAAssetRegistry",
      DEPLOYED_ADDRESSES.registry
    );

    const ASSET_FACTORY_ROLE = await registry.ASSET_FACTORY_ROLE();
    const ASSET_MANAGER_ROLE = await registry.ASSET_MANAGER_ROLE();
    const PAYMENT_COLLECTOR_ROLE = await registry.PAYMENT_COLLECTOR_ROLE();
    const COMPLIANCE_ROLE = await registry.COMPLIANCE_ROLE();

    console.log("Verifying roles for admin:", ADMIN_ADDRESS);
    expect(
      await registry.hasRole(ASSET_FACTORY_ROLE, ADMIN_ADDRESS),
      "Admin should have ASSET_FACTORY_ROLE"
    ).to.be.true;
    expect(
      await registry.hasRole(COMPLIANCE_ROLE, ADMIN_ADDRESS),
      "Admin should have COMPLIANCE_ROLE"
    ).to.be.true;

    console.log("Verifying roles for agent:", AGENT_ADDRESS);
    expect(
      await registry.hasRole(ASSET_MANAGER_ROLE, AGENT_ADDRESS),
      "Agent should have ASSET_MANAGER_ROLE"
    ).to.be.true;
    expect(
      await registry.hasRole(PAYMENT_COLLECTOR_ROLE, AGENT_ADDRESS),
      "Agent should have PAYMENT_COLLECTOR_ROLE"
    ).to.be.true;

    console.log("Role verification successful!");
  });

});
